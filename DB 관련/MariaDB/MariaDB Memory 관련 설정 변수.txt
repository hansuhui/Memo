http://sqlmvp.kr/220340062504

[MySQL/MariaDB Memory 관련 설정 변수]


MySQL/MariaDB 서버에서 메모리 관련된 설정이 중요하다. MySQL에서 스토리지 엔진별로 주요 메모리
공간이 공유되지 않기 떄문에 사용하는 스토리지 엔진에 맞게 메모리 사용을 제한하는 것이 중요하다.

여기에서는 중요한 변수 몇 가지만 소개한다. 자세한 내용은 공식 메뉴얼을 참고한다.

설정 가능한 변수 목록은 show variables 명령을 사용하여 확인 할 수 있다.

show variables;


- innodb_buffer_pool_size : 디스크에서 데이터를 메모리에 캐싱함과 동시에 데이터의 변경을
  버퍼링 하는 역할을 수행한다. 일반적으로 전체 메모리의 50 ~ 80% 까지 설정하며 낮은 값부터
  조금씩 크기를 올려가며 적절한 값을 찾는 것이 좋다. 정적 변수이기 떄문에 설정 적용을 위해서는
  MySQL 재시작이 필요하다.

- join_buffer_size : 조인이 발생할 대마다 사용되는 버퍼가 아니다. 적절한 조인 조건이 없어서
  드리븐 테이블의 검색이 풀 테이블 스캔으로 유도되는 경우 사용된다.

- key_buffer_size : MyISAM의 키 버퍼는 인덱스를 메모리에 저장하는 버퍼의 크기이다.
  인덱스만 캐시하기 때문에 InnoDB의 버퍼 풀만큼 할당해서는 안된다. 일번적으로 전체 매모리의
  30 ~ 50% 할당하는 것이 좋다.

- read_buffer_size : MySQL 메뉴얼에서는 풀 테이블 스캔이 발생하는 경우 사용하는 버퍼라고
  설명하고 있지만 많은 스토리지 엔젠에서 다른 용도로 사용하기도 하기 떄문에 명확히
  정의하기 어렵다.

- sort_buffer_size : 인덱스를 사용할 수 없는 정렬 메모리 공간을 얼마나 할당할지 결정하는 
  설정값이다 . 이 크기가 너무 작으면 디스크 사용확률이 높아지고 높아지면 클라이언트 스레드가
  사용하는 메모리의 양이 커져 메모리 낭비가 심해진다. 이 메모리 공간이 크다고 해서
  무조건 정렬이 빨리 끝나는 것이 아니다.

- tmp_table_size : 메모리에 생성되는 임시 테이블의 최대 크기를 설정한다.

- Query_cache_size , query_cache_limit : 쿼리 캐시에 관련된 캐시의 크기를 설정한다.
  캐시는 무조건 크게 설정하는 것이 항상 좋은 것은 아니다.

- key_cache_block_size : block 크기이며 기본값 1024(단위 byte) 이다.

- myisam_sort_buffer_size : Repair table , Alter table , CREATE INDEX에
  사용되는 버퍼 메모리 크기이다. 최대크기는 4GB이다.


