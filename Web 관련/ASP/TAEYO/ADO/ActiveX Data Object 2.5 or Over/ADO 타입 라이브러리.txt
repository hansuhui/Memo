[ADO 타입 라이브러리]


이번 강좌는 ASP 페이지에서 데이터베이스를 연동할 경우. 필요한 상수들에 대한 이야기입니다.
기존에는 Adovbs.inc 라는 파일을 통해 ADO에 관련된 여러가지 상수들을 사용할 수가 있었습니다.

Adovbs.inc라는 파일은 어떤 파일일까요? 그 파일이 하는 역할은 무엇일까요? 간단하게 말씀드리면, 
Adovbs.inc라는 파일은 ADO를 사용할 경우 필요한 상수들을 저장해 놓은 파일입니다. 
IIS가 설치되면 같이 설치되어지는 파일이지요.

기본적으로는  C:\Program Files\Common Files\System\ado 라는 폴더에 이것은 존재합니다.  
좀 더 이 파일을 이해하기 위해서 다음과 같은 코드를 살펴봅시다.


SQL = "select * from Members"
Rs.Open SQL, Dbcon,0,1

위의 한 줄의 코드가 의미하는 것은 무엇인가요? 수도 없이 ASP 페이지에서 데이터베이스를 연동하신 분들은 알고 있겠지만...
이것은 레코드셋을 오픈하면서 ForwardOnly 으로 커서를 지정하여, 락타입도 ReadOnly로 지정한다는 것입니다.

즉,이 레코드셋 내의 담긴 레코드들을 살피기 위해서.. 오로지 전진만이 있을뿐이구요, 그 안에 내용을
업데이트 할수 없다는 것입니다. 가장 제한적으로 레코드 셋을 여는 것이지요... 아니?? 어떻게 ForwardOnly 레코드셋 오픈
,락타입은 ReadOnly로 지정한다는 것을 알 수가 있느냐구요?

바로 위에 코드의 3,4번째 인자인 빨간 색 부분의 코드가 그것을 의미하는 것이지요. 0 , 1 말입니다. ASP 관련 서적을 보시면
3번째 인자는 레코드 셋의 커서타입이고, 그 종류에는 뭐가 있고 , 각각의 값이 하는 것은 어떤 것이다~~ 라고 나와 있습니다.
Lock 타입도 마찬가지이구요...

하지만 그 값이 어떤 역할인지 책에는 있다치더라도 그것들이 쉽게 외워지지는 않을 것입니다.
하지만, 그 값 대신 영어로 원래의 역할에 맞게 표기된다면  (예를 들어, Keyset, Dynamic, ForwardOnly등등....) 
이것은 코드를 이해하기에 더욱 도움이 될 것입니다. 예를 들면 다음처럼 말입니다

Rs.Open SQL, Dbcon, ForwardOnly, LockReadOnly

어떤가요? 기존의   Rs.Open SQL, Dbcon, 0, 1 에 비해서 훨씬 가독성이 높지요? 
그렇습니다. 그리고, 외국코드들을 보면 이런 식으로 상수를 사용하고 있는 것을 볼 수가 있습니다. 
외국 서적들도 마찬가지이구요... 물론, 여러분중에도 이미 사용하시고 계시는 분들도 있구요. 
하지만 우리 맘대로  Rs.Open SQL, Dbcon, ForwardOnly, LockReadOnly 이렇게 코드를 사용할 수는 없습니다.

정히 이렇게 사용하고 싶다면 먼저... 그 상수와 값을 각각 세팅해 주어야 하겠지요? 다음과 같은 식으로 말입니다.

Const  ForwardOnly = 0
Const  LockReadOnly = 1
Rs.Open SQL, Dbcon, ForwardOnly, LockReadOnly


그렇다면, 이제 여러분은 Adovbs.inc 의 역할을 대충 눈치채셨을 것입니다.  
이 파일의 역할은 바로 그러한 상수들을 미리 정의해 놓고, 
위와 같이 사용할 수 있게끔 한 것이랍니다. 
그 파일을 열어보시면 다음과 같이 ADO에 사용될 수 있는 모든 상수들이  정의 되어져 있는 것을 볼 수가 있습니다..  
커서 타입은 젤루 처음에 나와있네요.


<!--#include file="C:\Program Files\Common Files\System\ado\adovbs.inc" -->

, Adovbs.inc 파일을 ASP 페이지안에 인클루드해서 사용하는 것이 가독성에는 도움이 되나 0 이나 1 처럼 
그 값을 직접 사용할 경우보다는 속도면에서 떨어지는 것입니다.  
도움이 되면서 문제가 된다???  그렇습니다... 바로 우리로 하여금 갈등을 유발 시키고 있는 것이지요....


해서 현재는 보다 좋은 대안으로써 모든 ADO 상수(ADO constants)들을 어플리케이션 차원에서 
연결하라고 제안하고 있는데, 그것은 타입 라이브러리를 사용하는 방법이며, 제가 이번 강좌에서 드리고 싶었던 이야기입니다.

다음과 같은 코드를 ADO 상수가 필요한 ASP 페이지의 상단에서 넣어줌으로 해서 
ADO 상수들에 대한 타입 라이브러리를 참조할 수 있게 됩니다. 이 것만 소스에 넣어주면 만사해결이라는 의미이지요....

이것이 바로 이번 강좌의 핵심(?)이라 볼수 있는 타입 라이브러리를 사용하라는 것입니다.

<!--METADATA TYPE= "typelib"  NAME= "ADODB Type Library"
      FILE="C:\Program Files\Common Files\SYSTEM\ADO\msado15.dll"  -->

혹은

<!--METADATA TYPE="typelib"  NAME="ADODB Type Library
      UUID= "00000205-0000-0010-8000-00AA006D2EA4" -->

라고 말입니다.

또한, 아예 이 코드를 Global.asa에 추가함으로 해서 우리의 어플리케이션안에서는 
어디서나 ADO 상수들을 사용 가능토록 할 수도 있습니다. 
그렇게 Global.asa에서 연결해 주게 되면 여러분은 그 웹 어플리케이션내의 모든 
ASP 페이지에서 이 코드를 다시 추가할 필요없이 ADO 상수를 마음껏 사용할 수 있게 되거든요.



[요점]
1. ADO를 사용할 경우의 상수값을 위해서 우리는 Adovbs.inc를 사용할 수 있다.
2. Adovbs.inc 파일은 ADO용 상수를 정의해놓은 인클루드용 파일이다.
3. 그러나, Adovbs.inc 파일을 사용하는 것 보다, 
   그에 대응하는 값(0, 1, 2 등등)들을 바로 써주는 것이 속도향상 효과가 있다.
4. 그보다 더 나은 방법은 타입 라이브러리 파일을 연결하는 것이다.
    그리고, 이 파일을 Global.asa에서 연결하면 사이트내에서는 어디서나 이 값의 사용이 가능하다


