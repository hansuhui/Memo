ASP 기본 문법 II

데이터 타입 이라는 용어는 변수에 어떤 값을 넣을때, 그것이 어떤 형식의 값인지를 알아보려는 것 입니다.
ASP 상에서 어떤 변수에 숫자,문자, 날짜 처럼 각각다른 타입의 값을 넣으려 할 때 어떻게 해야 하는지,그리고
그것들의 차이는 무엇이 있는지를 알아보려 하는 것입니다.


[데이터 타입]

숫자 서브 타입 - 정수나 분수, 또는 부동 소수점 등 다섯개의 타입이 있다.
문자열 서브 타입 - 텍스트 정보를 보관한다.
날짜 서브 타입 - 날짜와 시간을 보관하는 데 쓰이는, 미리 정해진 타입이다.
부울린 서브 타입 - 참,거짓을 의미하는 TRUE 또는 FALSE 값 중 하나를 가진다.
그 외의 서브 타입 - Empty, Null 등을 알아본다.




=============

1.숫자 서브 타입

변수에 숫자가 들어가면 그것이 바로 '숫자 서브 타입'이 됩니다. 
하지만 숫자의 크기에 따라서 다음 여섯 가지 정도의 타입으로 다시 나눌 수가 있습니다.

1-1. 정수(Integer) : 숫자 타입 중에서 가장 일반적으로 쓰이는 타입입니다.
		     -32,768 부터 32,767 사이의 정수가 바로 Integer 타입에 해당하게 됩니다.
		     (참고로 32,767은 2의 15승에서1을 뺸 숫자가 되겠습니다.)	


1-2. 바이트 (byte) : 0 ~ 255 까지의 정수 (2의 8승 -1 )가 Byte 타입에 해당합니다.
                     이 타입은 기본적인 솟자의 연상에 사용되는 타입니다.

1-3. 긴 정수(Long) : 이것은 Integer 타입과 유사하지만 휠씬 더 큰 수를 지원하는 타입입니다.
		     -2,147,483,648 부터 2,147,483,647 사이의 정수(2의 31승 - 1)가 이 Long 타입에 해당합니다.

1-4. 싱글(Single) :  -3.402823E38 부터 -1.401298E-45 까지의 음수
		    그리고 1.401298E-45 부터 3.402823E38 까지의 양수 단정도 부동소수점을 지원하는 타입입니다.


1-5. 더블(Double) : 음수에 대해서는 -1.79769313486232E308 부터 -4.94065645841247E-324 까지
		    양수에 대해서는 4.94065645841247E-324 부터 1.79769313486232E308 까지의
		    배정도 부동소수점을 지원합니다.


1-6. 통화(Currency) : 화폐 단위를 의미하는 데이터 타입입니다.
		      이 타입은 소숫점 네자리까지의 숫자를 지원하는데요. 지원하는 범위는
	  	      -922,337,203,685,477.5808 ~ 922,337,203,685,477.5807 까지 입니다.


=============

2.문자열 서브 타입


문자열 서브 타입은 말 그대로 문자열을 보관합니다. 면자열 서브 타입을 정의하기 위해서는 문자열의 앞뒤에 큰 따옴표(")를
붙여주면 됩니다. 


=============

3. 날짜 서브 타입

날자정보를 저장하는 날짜 서브 타입을 사용하려면, 정해진 규칙을 사용해야만 합니다.
표현하고자 하는 날짜의 앞뒤에 "#" 기소로 둘러 싸는 것이 바로 그 규칙이 되겠습니다.
예를 들어 1975년 1월 19일을 날짜 서브 타입으로 나타내면 다음과 같습니다.

#01/19/1975#

만약 여기서 "#"기호를 뺴고 사용하면 어떻게 될까요? 이 경우 ASP에서는'날짜 서브 타입'이 아닌 '숫자 서브 타입'으로
인식하게 됩니다. 그러므로 우선 1에서 19를 나누고 그 결과 값에 다시 1975을 나는 값을 인식하게 됩니다.


=============

4.부울린(Boolean) 서브 타입

부울린 서브 타입이라는 말은 우리 말로 하면 '참,거짓 서브 타입'정도로 말할 수 있겠습니다. 즉 이 타입에서는
참(TRUE)아니면 거짓(FALSE) 값만을 가질 수 있는 것이지요. 참고로 이 값을 ASP 상에서 정수형으로 변환할 수도 있는데요.
이 경우 TRUE는 -1의 값을 , FALSE는 0의 값을 가지게 됩니다.


=============

5. 그 외의 서브 타입

그 외의 특별한 타입으로는 Empty 와 Null, Object , Error 등이 있는데요. 우리는 이중에서 Empty와 NULL에 
대해서만 알아보도록 하겠습니다. 

5-1. Empty : Empty라는 단어의 사전적인 의미는 '비어있다'는 뜻입니다.
             마찬가지로 Empty 변수는 '값을 전혀 가지고 있지 않다'는 뜻으로 사용됩니다.

5-2. NULL : 이것은 데이터베이스와 연결하여 사용되는 특별한 데이터 타입입니다.
	    아무 것도 아니고 , 데이터 타입도 아니고 , 데이터를 가지고 있지도 않은 것....
	    이것이 바로 NULL의 의미가 되겠습니다.






[데이터 변환 함수]


숫자 서브 타입 관련 - CInt, CLng , CByte , CSng, CCur , Fix ,Int , Abs
문자열 서브 타입 관련 - CStr , Asc, AscB, AscW ,Chr , ChrB , ChrW
날자 써브 타입 관련 - CDate , DateValue , TimeValue, DateSerial , TimeSerial
부울린 서브 타입 - CBool
기타 변환 함수  - Hex , Oct , Sgn


1-1. CInt , CLng

CInt와 CLng 함수는 숫자형으로 변환하는 함수 중에 가낭 많이쓰이는 함수입니다.
Int는 정수형(Integer), CLng는 긴 정수형(Long)의 값으로 변환시켜 주는 함수지요.

예를 들면 다음과 같습니다.

DIM intFirst, intSecond , intPlus
inttFirst = CInt("200")
intSecond = Cint("400")
intPlus = inttFirst + intSecond

이처럼 CInt는 인자로들어온 값을 '숫자 서브 타입'으로 변경해주는 함수 입니다.

그런데 만약  intSecond = CInt ("50000") 같이 사용하면 어떻게 될까요? 네 이경우엔 '오버플로우'라는 오류를 만나게 됩니다.
정수형(Integer)의 한계치인 32,767을 넘어갔기 때문이지요. 이떄에는 CLng를 사용 intSecond = CLng("50000") 

그리고 CInt 와CLng 는 정수형 타입이므로소수점을 포함한 숫자가 인자로 들어온다면 '반올림한 정수'를 돌려준다는 사실을
추가적으로 기억해 주시기 바랍니다. (절반일떈 내림)!!



1-2. CByte, CSng , CDbl , CCuur

CByte 는 CInt 와 마찬가지로 정수 값을 반환해 줍니다. (반올림 규칙도 일치합니다.) 
하지만 변환된 값이 0 ~ 255 사이의 값이 아니라면 오류가 발생합니다.
CSng 와 CDbl 도 각각 Single, Double 형의 값을 반환해 주는데요. 
예를 들어서 다음 두 변수에 같은 값을 인자로 주었다고 가정해 보겠습니다.


intFirst = CSng ("12345.54321")
intSecond = CDbl ("12345.54321")

이때 intFirst 값은 12345.54, intSecond 값은 12345.54321 으로 나타나게 됩니다. 
(결과 자체보다는.. CSng 보다 CDbl 이 정밀하다는 사실을 기억해두시기 바랍니다.)


CCur 역시 CSng, CDbl 과 마찬가지이지만 '통화' 용도로 사용된다는 설명을 드렸었지요? 
CCur 은 특이하게도 소수점 5자리에서 반올림을 하게 됩니다. 
즉, CCur ("12345.54321") 이라고 한다면 12345.5432 라는 값이 반환되는 것이지요.


1-3. Fix, Int, Abs

Fix 와 Int 는 모두 '잘라내기를 통해 숫자의 정수 부분을 반환' 하는 함수입니다. 
즉 Fix (9.8) 이나 Int (9.8) 모두 똑같이 9 라는 값을 반환한다는 뜻이지요. 
그렇다면 이 두 함수의 차이는 무엇일까요? 그것은 바로 음수의 처리에 있습니다. 
쉽게 말씀드리자면 Fix (-9.8) 은 -9를, Int (-9.8) 은 -10을 반환한다는 의미인 것입니다. 
(즉, Fix 는 소수점 이하 숫자를 없애버리는 것이고, Int 는 '내림' 을 하는 것이지요.)

Abs 는 수학에서 많이 쓰이는 함수인데요.. 절대값을 반환합니다. 
즉 Abs (-3.5) 나 Abs (3.5) 모두 3.5 라는 값을 반환하게 되지요.
 

=============

2.문자열 서브 타입 관련

2-1. CStr

CStr 은 말 그대로 '문자열' 로 바꾸어주는 함수가 되겠습니다. 
예를 들어서 intFirst 라는 변수를 선언한 다음, intFirst = 503 이라고 한다면 
intFirst 변수에는 자동적으로 503 이라는 '숫자 서브 타입의 값' 이 들어가게 될 것입니다. 
이때, strFirst = CStr(intFirst) 라는 구문을 실행하게 되면 strFirst 에는 "503" 이라는 '
문자열 서브타입의 값' 이 들어가게 되는 것이지요.

2-2. Asc, AscB, AscW

Asc 함수는 문자열 첫 글자의 'ANSI 문자 코드' 를 반환합니다.
우리가 키보드에서 입력하는 모든 문자들에는 각각 고유한 값이 있는데요.
그걸 정한 애들이 ANSI 이고 , 그렇게 정의된 값들이 ASCII 값이다. 정도만 아시면 됩니다.

에를 들어볼까요? Asc ("A") 의 값은 65, Asc ("B") 는 66, Asc ("C") 는 67... 
이런식으로 진행하여 Asc ("Y") 는 89, Asc ("Z") 는 90 이라는 값이 됩니다. 
(참고 삼아 말씀드리면, Asc 는 대문자와 소문자의 값이 서로 다릅니다. 
즉 Asc ("A") 는 65 지만, Asc ("a") 는 97 입니다. 혼동하시면 아니되옵니다.)


그 뒤에 나오는 AscB 와 AscW 함수는 우리가 사용할 일이 거의 없는 함수입니다만 
쓰임새에 대해서만 간략하게 말씀드리자면... AscB 는 바이트에 대해 쓰이고, 
AscW는 UNICODE를 이용하는 32-비트 플랫폼에서 이용된다고 하네요.


2-3. Chr, ChrB, ChrW

Chr 함수는 Asc 의 반대 함수로, 코드 값을 입력하면 그에 해당하는 문자를 반환합니다. 
즉, Chr (65) 라고 하면 "A" 라는 값을 반환한다는 의미가 되지요. 
마찬가지로 ChrB 와 ChrW 함수도 각각 AscB 와 AscW 함수의 반대 함수가 되겠습니다.

참고로.. 큰 따옴표(")를 의미하는 Chr (34) 번이나, 글의 내용을 입력하는 
TEXTAREA 에서 개행을 의미하는 Chr (13), Chr (10) 같은 함수들은 꽤 빈번하게 쓰이는 편이니까요. 
이것들은 상식으로 알아두시면 나중에 유용하게 사용할 때가 있을 것입니다.



=============

3. 날짜 서브 타입 관련

3-1. CDate

CDate 함수는 인자로 들어온 값을 '날짜형' 으로 바꾸어 주는 함수입니다. 
하지만 인자에 '날짜로 변환할 수 없는 형식의 값' 이 들어오면 오류를 발생시킵니다. 
예를 들면 다음과 같습니다.

CDate ("2003년 7월 16일 19:00")
ISDATE ("2003년 7월 16일 19:00")

이 함수의 결과는 '2003-07-11 오후 7:00:00' 이 됩니다. 
하지만 다음처럼 컴퓨터가 알아볼 수 없는 형식의 문자열을 넣으면 오류를 발생시킵니다.

CDate ("이천삼년 칠월 십육일 일곱시")

ISDATE ("이천삼년 칠월 십육일 일곱시")

'그렇다면 컴퓨터가 알아먹는 날짜 형식이 어떤건데?' 라고 질문이 나올 법 한데요. 
이럴 때를 대비해서 ASP 는 ISDATE라는 함수를 제공합니다. 
이 함수는 '날짜형' 으로 변환이 가능한지 아닌지를 알려줍니다. 
즉 ISDATE ("2003년 7월 16일 19:00") 은 변환이 가능하므로 True 값을 반환하게 되고요. 
ISDATE ("이천삼년 칠월 십육일 일곱시") 는 변환이 불가능하므로 False 값을 반환합니다


3-1. DateValue, TimeValue, DateSerial, TimeSerial

날짜 서브 타입 관련 함수 중에서 조금 더 세분화 된 함수들이 있는데요. 
날짜에 관련된 함수로는 DateValue, DateSerial 이 있고, 
시간에 관련된 함수로는 TimeValue, TimeSerial 이 있습니다. 
DateValue 와 DateSerial 함수는 결과값으로 모두 '년-월-일' 을 반환하는데요.

DateValue ("2003년 7월 16일 19:00:32")
DateSerial (2003,7,16)

이렇듯 DateValue 는 인자가 하나이고, DateSerial 은 인자가 세개라는 차이가 있습니다. 
(두 함수 모두 날짜를 반환하는 함수이므로.. 결과는 "2003-07-16" 으로 동일합니다.) 또한, 
시간과 관련된 TimeValue 와 TimeSerial 함수는 '시-분-초' 를 반환합니다.

TimeValue ("2003년 7월 16일 19:00:32")
TimeSerial (19,0,32)

DateValue, DateSerial 함수와 사용법은 같다고 보셔도 무방하겠습니다. 
위의 예제에서 보듯이 TimeValue는 인자가 하나, 
TimeSerial 은 인자가 세개입니다. (결과는 두 함수 모두 "오후 7:00:32" 로 같다는 것은... 이미 짐작하고 계셨다고요?)


=============

4. 부울린 서브 타입 관련


4-1. CBool

CBool 함수는 참, 거짓을 판별하여 True 와 False 값중 하나를 반환합니다. 
CBool 함수의 인자로는 '숫자' 나 '유효한 식' 이 들어갈 수가 있는데요. 
숫자가 인자로 들어가는 경우 0일때는 False, 나머지 숫자인 경우에는 True 를 반환합니다. 

예를 들면 다음과 같이 되는 것이지요.

CBool(0) -> False 를 반환합니다.
CBool(1) -> True 를 반환합니다. (0이 아닌 다른 모든 수)

식이 들어가는 경우의 예를 들어보면 다음과 같은데요.

CBool ("a" = "a") -> True 를 반환합니다.
CBool ("a" = "b") -> False 를 반환합니다.

하지만 CBool ("exhibition") 과 같이 '숫자' 도 '식' 도 아닌.. 
단순한 문자열을 넣는 경우에는 오류를 발생시키므로 주의하셔야 하겠습니다.


=============

5. 기타 변환 함수

5-1. Hex, Oct, Sgn

자주 쓰이지는 않지만 알아두면 좋을 변환 함수로는 Hex, Oct, Sgn 등이 있습니다. 
우선 Hex 함수는.. 인자로 들어온 값 (10진수) 의 '16진수로 변환된 값' 을 반환합니다. 
즉, Hex (10) 라고 한다면 "A" 를 반환하게 되겠지요. 
Oct 함수는 인자로 들어온 값 (10진수) 의 '8진수로 변환된 값' 
을 반환합니다. Oct (10) 이라고 하면 Hex 와는 달리 '12' 를 반환하게 됩니다.
(참고로.. Hex 는 hexadecimal, Oct 는 octal 의 약자로 각각 16진법, 8진법을 의미합니다. 
8진법과 16진법에 대한 설명은 중학교 수학 교과서를 참고하시기 바랍니다. -_-a)

Sgn 함수는 수의 부호를 나타내는 정수를 반환하는데요.양수라면 1을, 음수라면 -1을, 그리고 0이라면 0을 반환합니다.

Sgn (52.3) -> 1 을 반환합니다.
Sgn (-2.5) -> -1 을 반환합니다.
Sgn (0) -> 0 을 반환합니다.
































