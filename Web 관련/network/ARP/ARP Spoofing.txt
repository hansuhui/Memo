주소 결정 프로토콜(ARP) 캐시 메모리를 변조시켜 공격 대상의 MAC 주소를 자신의 컴퓨터의 MAC 주소로 변경하려면
모든 데이터가 자신의 컴퓨터로 모니터링이 가능한 공격 기법, 과거에 해커는 유명한 웹 서버 자체를 공격해 악성 코드
경유지로 활용했다. 그러나 웹 서버 보안이 강화되자, 네트워크의 서브넷 내에 침투해 ARP 위장 패킷으로 해당 서브넷내의
PC들을 감염시키는 기법이다. 어떤 시스템에 ARP 위장 기능을 가진 악성 코드가 설치되면 약간의 조작으로 동일 구역 내의
다른 시스템에 쉽게 악성 코드가 설치될 수 있다.



=======================================================================================

ARP 스푸핑 (ARP spoofing)은 근거리 통신망(LAN)하에서 주소 결정 프로토콜(ARP) 메시지를 이용하여
상대방의 데이터 패킷을 중간에서 가로채는 중간자 공격 기법이다. 이 공격은 데이터 링크 상의 프로토콜인 ARP
프로토콜을 이용하기 때문에 근거리상의 통신에서만 사용할 수 있는 공격이다.

이 기법을 사용한 공격의 경우 특별한 이상 증상이 쉽게 나타나지 않기 때문에 사용자는 특별한 도구를 사용하지 않는 이상
쉽게 자신이 공격당하고 있다는 사실을 확인하기 힘들다.



- 과정

로컬 영역 네트워크에서 각 장비의 IP 주소와 MAC 주소간의 대응은 ARP 프로토콜을 통해 이루어진다. 이때
공격자가 의도적으로 특정 IP 주소와 자신의 MAC 주소로 대응하는 ARP 메시지를 발송하면 , 그 메시지를
받은 장비는 IP 주소를 공격자 MAC 주소로 인식하게 되고 , 해당 IP 주소로 보낼 패킷을 공격자로 전송하게 된다.
이 떄 공격자는 그 패킷을 원하는 대로 변조한 다음 원래 목적지 MAC 주소로 발송하는 공격을 할 수도 있다.
흔히 사용하는 공격 방식은 게이트웨이 IP를 스푸핑하는 것으로 , 이 경우 외부로 전송되는 모든 패킷이 
공격자에 의해 가로채거나 변조될 수 있다. 또는 , 두 노드에 각각 ARP 스푸핑을 하여 두 장비의 중간에서
조작하는 기법도 자주 사용된다.

- 은닉성
와이어샤크와 같은 패킷 감지 프로그램을 이용하면 주기적으로 자신의 주소가 아님에도 
불구하고 ARP 신호를 보내느 패킷을 확인할 수 있기 때문에 쉽게 감지할 수 있다.

- 방어 방법

=정적 ARP 엔트리 사용

로콜 방식에서 사용되는 공격 방식이기 때문에, 로컬 ARP 캐쉬를 정적으로 정의할 수 있다.
이 경우 ARP 신호를 받아도 무시하기 떄문에 운영체제에서 제대로만 관리된다면
완벽한 방어 방법으로 사용할 수 있다.

= ARP 스푸핑 감지 소프트웨어

ARP 스푸핑을 확인하는 스프트웨어는 ARP 응답을 상호확인하는 방법이나,
특별한 형식의 인증서를 사용한다. 인증되지 않은 ARP 응답은 차단된다.



----------------------------------------------------------------------------------------

ARP spoofing에 대응할 수 있는 대책으로는, 네트워크 관리자가 게이트웨이에서 정적 ARP
Table을 관리하고, 스위칭 장비에서 각 포트별 정적인 MAC 설정 및 서버에서도 정적인 ARP
cache로 운용하는 것이 바람직하다. 현실적으로는 지켜지기 어렵지만, NIC 또는 서버나 라우터의
교체가 빈번하지 않은 IDC환경에서는 충분히 관리할 수 있을 것이다.
그리고 만약 특정 호스트로부터 지속적인 ARP 패킷이 수신된다면 비정상적인 호스트일 가능
성이 높으므로 주의해야 한다. ARP cache를 감독하기 위한 도구도 있는데, 예를 들면 arpwatch[5]
라는 프로그램은 ARP cache를 모니터링하여 변경되는 경우에는 관리자에게 알린다.




